#AutoIt3Wrapper_UseX64=n ; Compile to 32-bit.
#AutoIt3Wrapper_UseUpx=y ; Pack with UPX
#AutoIt3Wrapper_Run_After=upx.exe --ultra-brute "%out%" ; Compress further.
; Gui includes.
#include <ButtonConstants.au3>
#include <EditConstants.au3>
#include <GUIConstantsEx.au3>
#include <WindowsConstants.au3>
; End of Gui includes.
#include <lib/NomadMemory.lib> ; Used for reading and writing to process memory.
#include <lib/FMod.lib> ; Used for playing Tracker Modules.

Local $Form1 = GUICreate("5C4RL37 D3V1L5", 220, 108) ; Title Bar
Local $Button1 = GUICtrlCreateButton("Patch", 70, 52, 75, 25, $WS_GROUP) ; Patch Button
Local $About = GUICtrlCreateEdit("CRKME1" & @CRLF & "Cracked by: 7H30P3R470R", 10, 10, 200, 40, BitOR($ES_MULTILINE, $ES_READONLY)) ; Signature
Local $Input1 = GUICtrlCreateInput("", 8, 80, 206, 21, $ES_READONLY) ; Status
GUISetState(@SW_SHOW) ; Show the window.

global $patched = 0 ; Constant used to check if our process has been patched or not.
While 1
	local $PID
	local $openmem

	$PID = ProcessExists("CRKME1.exe") ; Define our process here.

	; Get Process ID
	$openmem = _MemoryOpen($PID) ; Get the Process ID of our target process.

	$nMsg = GUIGetMsg() ; Handle Gui Controls.
	Switch $nMsg
	  Case $GUI_EVENT_CLOSE ; Close the program.
		 _Exit()
		 Exit
	  Case $Button1
		 ; Assembly OpCodes
		 ; JE  = 0x74
		 ; JNE = 0x75
		 _MemoryWrite(0x426148, $openmem, 0x458B1575) ; Write JNE over the existing JE at the target address in memory.
		 $patched = 1
	  EndSwitch
	  If($PID==0) Then ; Handler for if the process isn't running.
		 GUICtrlSetData($Input1, "Process Not Found!")
		 $patched = 0 ; Reset our constant to 0 if process is closed or not running.
	  Else
		 if ($patched=0) then ; Process is found but not patched.
			GUICtrlSetData($Input1, "Ready to patch!")
		 ElseIf($patched=1) then ; Process has been patched
			GUICtrlSetData($Input1, "Successfully Patched!")
		 EndIf
	  EndIf
WEnd

; Play our classic Tracker Module with FMod.
Func Play_with_FMOD()
	Chip_Music()
	$chip = Binary($Chip_Music)
	$len = BinaryLen($chip)
	$tMem = DllStructCreate("byte[" & $len & "]")
	DllStructSetData($tMem, 1, $chip)
	$mod = LoadSongEx($tMem, 0, $len)
	FMusicMasterVolume($mod, 100)
	PlaySong($mod)
	SetLooping($mod, 1)
EndFunc

; Exit the program and free the memory of our music.
Func _Exit()
	StopSong($mod)
	FSound_Close()
	Close_DLL2()
	DllClose($_MDKernel32Dll)
	$tMem = ""
	$Chip_Music = ""
	Exit
EndFunc

; Embeded Tracker Module.
Func Chip_Music()
    $Chip_Music = '0x4E6976656C7261707065756D6100000000000000202020202020202020202020202D666C7566667921000577014004F6008100000000000000000000000000000000000000000000001B011A0000001B00000000000000000000000000000000000000000000000E002E0004000A00000000000000000000000000000000000000000000000E000F0004000A0000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000010000000000000000000000'
    $Chip_Music &= '00000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000001027F0001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000'
    $Chip_Music &= '0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004D2E4B2E010D100001402A0300D63000000000000000000000BE2C0A00000C100000000000000000010D2A0300000A01000000000000000001402C0A00000A010000000000000C0600D62A0300000A0100D6400000000000010D2C0A00000A0100000C05010D100000A02A0300BE300000000EB10000000000D62C0A0000000000000EB1010D100001402A0300B4330600000EB10000000000A02C0A00000C1000000EB100000C06010D2A0300000A0100BE40000000000001402C0A00000A0100000000012E100000D62A0300000A0100B4430600000000010D2C0A00000A0100000C050000000000A02A030000000000000EB10000000000D62C0A0000000000000EB1010D100001402A030000000000000EB10000000000A02C0A0000000000000EB100000000010D2A0300000000000000000000000001402C0A000000000000000000000C0600D62A03000000000000000000000000010D2C0A0000000000000000010D100000A02A0300BE3000000000000000000000D62C0A0000000000000000010D100001402A0300B43306000000000000000000A02C0A00000C100000000000000C06010D2A0300BE300000BE40000000000001402C0A0000000000000000012E10'
    $Chip_Music &= '0000D62A03011D332000B4430600000000010D2C0A00000C1000000C050000000000A02A0300000A0100BE40000000000000D62C0A00000A0100000000010D100001402A0300000A01011D43200000000000A02C0A00000A0100000C0500000000010D2A030000000000000EB10000000001402C0A0000000000000EB100000C0600D62A030000000000000EB100000000010D2C0A0000000000000EB1010D100000A02A0300BE3000000000000000000000D62C0A0000000000000000010D100001402A0300B43306000000000000000000A02C0A00000C100000000000000C06010D2A0300000A0100BE40000000000001402C0A00000A0100000000012E100000D62A0300000A0100B4430600000000010D2C0A00000A0100000C050000000000A02A030000000000000EB10000000000D62C0A0000000000000EB1010D100001402A030000000000000EB10000000000A02C0A0000000000000EB100000000010D2A0300000000000000000000000001402C0A000000000000000000000C0600D62A03000000000000000000000000010D2C0A0000000000000000010D100000A02A0300BE3000000000000000000000D62C0A0000000000000000010D100001402A0300B43306000000000000000000A02C0A00000C100000000000000C06010D2A0300BE300000BE40000000000001402C0A000000000000000000E210'
    $Chip_Music &= '0000D62A0300D6331000B4430600000000010D2C0A00000C1000000C050000000000A02A0300000A0100BE40000000000000D62C0A00000A0100000C05012E100001682A0300F0300000000EB10000000000A02C0A00000C1000000EB100000000011D2A0300000A0100000EB10000000001682C0A00000A0100000EB100000C0600F02A0300000A0100F0400000000000011D2C0A00000A0100000C05012E100000B42A030000000000000EB10000000000F02C0A0000000000000EB1012E100001682A030000000000000EB10000000000B42C0A00BE3ED300000EB100000C06011D2A0300B43310000000000000000001682C0A00000000000000000168100000F02A0300BE33070000000000000000011D2C0A00000C1000BE4ED30000000000B42A0300000A0100B443100000000000F02C0A00000A0100000000012E100001682A0300F0300000BE43070000000000B42C0A00000C1000000C0500000000011D2A0300000A0100000EB10000000001682C0A00000A0100000EB100000C0600F02A0300000A0100F0400000000000011D2C0A00000A0100000C05012E100000B42A030000000000000EB10000000000F02C0A0000000000000EB1012E100001682A030000000000000EB10000000000B42C0A00BE3ED300000EB100000C06011D2A0300B43310000000000000000001682C0A0000000000000000010D10'
    $Chip_Music &= '0000F02A0300BE33070000000000000000011D2C0A00000C1000BE4ED30000000000B42A0300000A0100B443100000000000F02C0A00000A010000000000F01000017D2A0300FE300000BE43070000000000B42C0A00000C1000000C0500000000011D2A0300000A0100000EB100000000017D2C0A00000A0100000EB100000C0600F02A0300000A0100FE400000000000011D2C0A00000A0100000C0500F0100000BE2A030000000000000EB10000000000F02C0A0000000000000EB100F01000017D2A030000000000000EB10000000000BE2C0A00BE3ED300000EB100000C06011D2A0300B433100000000000000000017D2C0A0000000000000000010D100000F02A0300BE33070000000000000000011D2C0A00000C1000BE4ED30000000000BE2A0300000A0100B443100000000000F02C0A00000A010000000000F01000017D2A0300FE300000BE43070000000000BE2C0A00000C1000000C0500000000011D2A0300000A0100000EB100000000017D2C0A00000A0100000EB100000C0600F02A0300000A0100FE400000000000011D2C0A00000A0100000C0500F0100000BE2A030000000000000EB10000000000F02C0A0000000000000EB100F01000017D2A03011D300000000EB10000000000BE2C0A00000C1000000EB100000C06011D2A0300000A010000000000000000017D2C0A00000A010000000000CA10'
    $Chip_Music &= '0000F02A0300000A01011D400000000000011D2C0A00000A0100000C050000000000BE2A030000000000000EB10000000000F02C0A0000000000000EB10000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF000306080A0C0F1214181A1B1C1C1D1E2023282F353A3E424547494A4C4E4F5051535455555657585859595A5A5A5A5A5B5B5B5A5A5A595958585757565554535251504F4E4D4C4B4948474543423E342007EACFB8A59589808080808080808080808080808080808080808080808080808080808080808080808080808080808080828487898B8E90929597999C9EA1A4A6A9ABAEB0B3B6B8BBBEC0C3C5C8CBCDD0D3D5D8DBDDE0E2E5E7EAECEFF1F4F6F9FBFE00020507090C0E10121517191B1D20222426282A2C2E30323436383836322C26201B17141210101010111213141617191A1C1E2021232527282A2C2E3031333536383A3B3D3F4042444547484A4B4D4E4F51525355565758595B5C5D5E5F6060616263646465666667676868686969696969696969696968686867676665656463626261605F5D5C5B5A585756545351504E4D4B4A48464542413F3C35291905F0DBC8B6A89C928982808080808080808080808080808080808080808080808080808080808080808080808080808081838587898B8D90929496989B9D9FA2A4'
    $Chip_Music &= 'A7A9ABAEB0B3B5B8BABDBFC2C4C7C9CCCFD1D4D6D9DBDEE0E3E5E8EAECEFF1F4F6F8FBFDFF020406090B0D0F111416181A1C1E20222426282A2C2E3031312F2C2824211D1A181716151515161617181A1B1C1E1F2123242627292A2C2E2F3132343537383A3B3D3E40414244454647494A4B4C4D4E4F5051525354555657575859595A5B5B5C5C5C5D5D5D5E5E5E5E5E5E5E5E5E5E5E5D5D5D5C5C5B5B5A59595857565554535251504F4E4C4B4A4847454442413F3E3C3B39373534312D251A0CFCECDDCEC0B4AAA199928C88848080808080808080808080808080808080808080808080808080808080808283858688898B8D8E90929496989A9C9EA0A2A4A6A8ABADAFB1B4B6B8BABDBFC1C4C6C8CBCDD0D2D4D7D9DBDEE0E2E5E7E9ECEEF0F3F5F7F9FCFE00020406090B0D0F11131517191B1D1F21232527292A2C2C2B2A282523201E1C1A191818181818191A1B1C1D1E1F212223252628292A2C2D2F30313334353738393B3C3D3E3F404142444546474748494A4B4C4D4D4E4F4F50505151525253535354545454545454545454545454545353535252515150504F4E4D4C4C4B4A4948474645434241403E3D3C3A393836353332302F2D2B292620180E03F7EBDED3C8BEB5AEA7A19C9794918E8C8A888786858484838383838383848484858586878888898A8B8D8E8F909193949697999A9C9D9FA1A2A4A6A8AA'
    $Chip_Music &= 'ABADAFB1B3B5B7B9BBBDBFC1C3C5C7C9CBCED0D2D4D6D8DADCDFE1E3E5E7E9EBEDEFF1F3F5F7F9FBFDFF01030507090B0C0E1012141617191B1D1E202223252525252422201F1D1B1A1918181717171818191A1A1B1C1D1F2021222324262728292B2C2D2E2F3032333435363738393A3B3C3D3D3E3F404141424343444545464647474848484949494A4A4A4A4A4A4A4A4A4A4A4A4A4A49494948484847474645454443434241403F3E3E3D3C3B3938373635343231302F2D2C2B29282625221E181008FEF5EBE1D7CFC7BFB8B3ADA9A5A19E9C999796949392929191909090909090919191929293949495969798999A9B9C9D9FA0A1A3A4A5A7A8AAABADAEB0B2B3B5B7B8BABCBEBFC1C3C5C7C9CBCCCED0D2D4D6D8DADCDEDFE1E3E5E7E9EBEDEFF0F2F4F6F8FAFBFDFF01030406080A0B0D0F1012141517181A1C1D1E20212121201F1E1D1C1A19181717161616161617171819191A1B1C1D1E1F2021222425262728292A2B2C2D2E2F30313233343536373738393A3A3B3C3D3D3E3E3F4040414141424243434344444444444445454545454545444444444443434242424141403F3F3E3E3D3C3B3A3A393837363534333231302E2D2C2B2A28272624221E1A140D05FCF4EBE3DAD3CBC5BFB9B4B0ACA8A5A3A19F9D9B9A99989897979696969696969797989899999A9B9B9C9D9E9FA0A1A2A3A4A6A7A8A9ABACAEAF'
    $Chip_Music &= 'B0B2B4B5B7B8BABBBDBFC0C2C4C6C7C9CBCDCED0D2D4D6D7D9DBDDDFE1E2E4E6E8EAEBEDEFF1F3F4F6F8FAFBFDFF0102040607090B0C0E101113141618191B1C1D1E1F1F1E1E1D1C1B1A191817161615151515161616171818191A1B1C1D1E1F2021222324252628292A2B2C2D2E2F3031323233343536373738393A3A3B3C3C3D3E3E3F3F4040414141424242434343434344444444444444444443434343424242414140403F3F3E3D3D3C3B3B3A393837363534333231302F2E2D2C2A29282624211D18120B03FBF3EBE3DCD5CEC7C2BCB8B3AFACA9A6A4A2A09F9D9C9B9A9A9999999999999999999A9A9B9B9C9D9D9E9FA0A1A2A3A4A5A6A7A8AAABACAEAFB0B2B3B5B6B8B9BBBCBEC0C1C3C5C6C8CACBCDCFD1D2D4D6D8D9DBDDDFE1E2E4E6E8E9EBEDEFF0F2F4F6F7F9FBFCFE0001030506080A0B0D0E101213151618191A1B1C1C1C1C1B1A1A19181716151514141414141414151516171818191A1B1C1D1E1F2021222325262728292A2B2C2D2E2F3031323233343536373738393A3A3B3C3C3D3D3E3F3F40404041414242424243434343434343434343434343434342424241414140403F3F3E3D3D3C3B3A3A393837363534333231302F2E2D2C2A292724211C17100A02FBF3ECE4DDD6D0CAC5C0BBB7B3B0ACAAA7A5A3A2A09F9E9D9D9C9C9B9B9B9B9B9B9C9C9C9D9D9E9F9FA0A1A2A3A4A4A5A7A8A9AAABAC'
    $Chip_Music &= 'AEAFB0B2B3B4B6B7B9BABCBDBFC1C2C4C5C7C9CACCCECFD1D3D4D6D8DADBDDDFE1E2E4E6E7E9EBEDEEF0F2F3F5F7F8FAFCFDFF0102040507090A0C0D0F10121315161718191A1A1A191918171616151414131313121213131314141515161718191A1B1C1D1E1F202122232425262728292A2B2C2D2E2F3031323334353536373838393A3B3B3C3D3D3E3E3F3F4040404141424242424343434343434343434343434342424241414140403F3F3E3E3D3C3C3B3A39393837363534333231302F2E2D2B292724201B150F0801FAF3ECE5DED8D2CCC7C2BEBAB6B2AFADAAA8A6A4A3A1A09F9F9E9E9D9D9D9D9D9D9D9E9E9E9F9FA0A1A1A2A3A4A5A6A7A8A9AAABACADAFB0B1B3B4B5B7B8B9BBBCBEBFC1C3C4C6C7C9CBCCCED0D1D3D5D6D8DADBDDDFE0E2E4E5E7E9EBECEEF0F1F3F5F6F8F9FBFDFE000203050608090B0C0E101112141516171818181818171616151414131312121212121212131314141516171718191A1B1C1D1E1F202122232425262728292A2B2C2D2E2F3031323334353536373838393A3B3B3C3C3D3E3E3F3F3F404041414142424242424243434343434342424242424141414040403F3F3E3D3D3C3B3B3A39383837363534333231302F2E2C2B2826221D18130D0600F9F2ECE5DFD9D3CEC8C4BFBBB8B4B1AFACAAA8A6A5A4A2A1A1A09F9F9F9E9E9E9E9F9F9FA0A0A1A1A2A3A3A4A5A6A7A8A9AA'
    $Chip_Music &= 'ABACADAEB0B1B2B3B5B6B8B9BABCBDBFC0C2C3C5C7C8CACBCDCFD0D2D4D5D7D9DADCDEDFE1E3E4E6E8E9EBEDEEF0F2F3F5F6F8FAFBFDFF000203050608090B0D0E101112141516161717171717161615141413131312121212121213131314151516171818191A1B1C1D1E1F202122232425262728292A2B2C2D2E2F303132323334353636373839393A3A3B3C3C3D3D3E3E3F3F3F40404041414141414142424242424141414141414040403F3F3E3E3D3D3C3B3B3A3939383736353434333231302F2E2C2B2926231F1A150F0903FDF6F0EAE4DED8D3CEC9C4C0BCB9B6B3B0AEABAAA8A6A5A4A3A2A1A1A0A0A0A0A0A0A0A0A1A1A1A2A3A3A4A5A5A6A7A8A9AAABACADAEB0B1B2B3B5B6B7B9BABCBDBEC0C1C3C4C6C8C9CBCCCED0D1D3D5D6D8DADBDDDFE0E2E4E5E7E900000000EFBCD7DCE1E5E9EDF1F4F8FBFD02416746423C38322D2924201C1814100C080503FFF9D292B7BBC1C6CBD0D4D9DFE2E6693A0000241403F3E4D8CFCCCCD0D8E1ECF9091C2E3C403C32251505F5E60000241403F3E4D8CFCCCCD0D8E1ECF9091C2E3C403C32251505F5E6'
EndFunc



